(self.webpackChunkelement_web=self.webpackChunkelement_web||[]).push([[6063],{"./node_modules/@babel/runtime/helpers/esm/defineProperty.js":(e,t,o)=>{"use strict";o.d(t,{A:()=>s});var n=o("./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js");function s(e,t,o){return(t=(0,n.A)(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}},"./node_modules/@babel/runtime/helpers/esm/toPrimitive.js":(e,t,o)=>{"use strict";o.d(t,{A:()=>s});var n=o("./node_modules/@babel/runtime/helpers/esm/typeof.js");function s(e,t){if("object"!=(0,n.A)(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var s=o.call(e,t||"default");if("object"!=(0,n.A)(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}},"./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js":(e,t,o)=>{"use strict";o.d(t,{A:()=>i});var n=o("./node_modules/@babel/runtime/helpers/esm/typeof.js"),s=o("./node_modules/@babel/runtime/helpers/esm/toPrimitive.js");function i(e){var t=(0,s.A)(e,"string");return"symbol"==(0,n.A)(t)?t:t+""}},"./node_modules/@babel/runtime/helpers/esm/typeof.js":(e,t,o)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}o.d(t,{A:()=>n})},"./node_modules/loglevel/lib/loglevel.js":function(e,t,o){var n,s;!function(){"use strict";n=function(){var e=function(){},t="undefined",o=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"],s={},i=null;function a(e,t){var o=e[t];if("function"==typeof o.bind)return o.bind(e);try{return Function.prototype.bind.call(o,e)}catch(t){return function(){return Function.prototype.apply.apply(o,[e,arguments])}}}function r(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(n){return"debug"===n&&(n="log"),typeof console!==t&&("trace"===n&&o?r:void 0!==console[n]?a(console,n):void 0!==console.log?a(console,"log"):e)}function l(){for(var o=this.getLevel(),s=0;s<n.length;s++){var i=n[s];this[i]=s<o?e:this.methodFactory(i,o,this.name)}if(this.log=this.debug,typeof console===t&&o<this.levels.SILENT)return"No console available for logging"}function m(e){return function(){typeof console!==t&&(l.call(this),this[e].apply(this,arguments))}}function d(e,t,o){return c(e)||m.apply(this,arguments)}function u(e,o){var a,r,c,m=this,u="loglevel";function h(e){var o=(n[e]||"silent").toUpperCase();if(typeof window!==t&&u){try{return void(window.localStorage[u]=o)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"="+o+";"}catch(e){}}}function v(){var e;if(typeof window!==t&&u){try{e=window.localStorage[u]}catch(e){}if(typeof e===t)try{var o=window.document.cookie,n=encodeURIComponent(u),s=o.indexOf(n+"=");-1!==s&&(e=/^([^;]+)/.exec(o.slice(s+n.length+1))[1])}catch(e){}return void 0===m.levels[e]&&(e=void 0),e}}function p(){if(typeof window!==t&&u){try{window.localStorage.removeItem(u)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}function f(e){var t=e;if("string"==typeof t&&void 0!==m.levels[t.toUpperCase()]&&(t=m.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=m.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?u+=":"+e:"symbol"==typeof e&&(u=void 0),m.name=e,m.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},m.methodFactory=o||d,m.getLevel=function(){return null!=c?c:null!=r?r:a},m.setLevel=function(e,t){return c=f(e),!1!==t&&h(c),l.call(m)},m.setDefaultLevel=function(e){r=f(e),v()||m.setLevel(e,!1)},m.resetLevel=function(){c=null,p(),l.call(m)},m.enableAll=function(e){m.setLevel(m.levels.TRACE,e)},m.disableAll=function(e){m.setLevel(m.levels.SILENT,e)},m.rebuild=function(){if(i!==m&&(a=f(i.getLevel())),l.call(m),i===m)for(var e in s)s[e].rebuild()},a=f(i?i.getLevel():"WARN");var y=v();null!=y&&(c=f(y)),l.call(m)}(i=new u).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=s[e];return t||(t=s[e]=new u(e,i.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return i.noConflict=function(){return typeof window!==t&&window.log===i&&(window.log=h),i},i.getLoggers=function(){return s},i.default=i,i},void 0===(s="function"==typeof n?n.call(t,o,t,e):n)||(e.exports=s)}()},"./node_modules/matrix-js-sdk/src/@types/event.ts":(e,t,o)=>{"use strict";o.d(t,{Bx:()=>s});var n=o("./node_modules/matrix-js-sdk/src/NamespacedValue.ts");let s=function(e){return e.RoomCanonicalAlias="m.room.canonical_alias",e.RoomCreate="m.room.create",e.RoomJoinRules="m.room.join_rules",e.RoomMember="m.room.member",e.RoomThirdPartyInvite="m.room.third_party_invite",e.RoomPowerLevels="m.room.power_levels",e.RoomName="m.room.name",e.RoomTopic="m.room.topic",e.RoomAvatar="m.room.avatar",e.RoomPinnedEvents="m.room.pinned_events",e.RoomEncryption="m.room.encryption",e.RoomHistoryVisibility="m.room.history_visibility",e.RoomGuestAccess="m.room.guest_access",e.RoomServerAcl="m.room.server_acl",e.RoomTombstone="m.room.tombstone",e.RoomPredecessor="org.matrix.msc3946.room_predecessor",e.PolicyRuleUser="m.policy.rule.user",e.PolicyRuleRoom="m.policy.rule.room",e.PolicyRuleServer="m.policy.rule.server",e.SpaceChild="m.space.child",e.SpaceParent="m.space.parent",e.RoomRedaction="m.room.redaction",e.RoomMessage="m.room.message",e.RoomMessageEncrypted="m.room.encrypted",e.Sticker="m.sticker",e.CallInvite="m.call.invite",e.CallCandidates="m.call.candidates",e.CallAnswer="m.call.answer",e.CallHangup="m.call.hangup",e.CallReject="m.call.reject",e.CallSelectAnswer="m.call.select_answer",e.CallNegotiate="m.call.negotiate",e.CallSDPStreamMetadataChanged="m.call.sdp_stream_metadata_changed",e.CallSDPStreamMetadataChangedPrefix="org.matrix.call.sdp_stream_metadata_changed",e.CallReplaces="m.call.replaces",e.CallAssertedIdentity="m.call.asserted_identity",e.CallAssertedIdentityPrefix="org.matrix.call.asserted_identity",e.CallEncryptionKeysPrefix="io.element.call.encryption_keys",e.KeyVerificationRequest="m.key.verification.request",e.KeyVerificationStart="m.key.verification.start",e.KeyVerificationCancel="m.key.verification.cancel",e.KeyVerificationMac="m.key.verification.mac",e.KeyVerificationDone="m.key.verification.done",e.KeyVerificationKey="m.key.verification.key",e.KeyVerificationAccept="m.key.verification.accept",e.KeyVerificationReady="m.key.verification.ready",e.RoomMessageFeedback="m.room.message.feedback",e.Reaction="m.reaction",e.PollStart="org.matrix.msc3381.poll.start",e.Typing="m.typing",e.Receipt="m.receipt",e.Presence="m.presence",e.FullyRead="m.fully_read",e.Tag="m.tag",e.SpaceOrder="org.matrix.msc3230.space_order",e.PushRules="m.push_rules",e.Direct="m.direct",e.IgnoredUserList="m.ignored_user_list",e.RoomKey="m.room_key",e.RoomKeyRequest="m.room_key_request",e.ForwardedRoomKey="m.forwarded_room_key",e.Dummy="m.dummy",e.SecretRequest="m.secret.request",e.SecretSend="m.secret.send",e.GroupCallPrefix="org.matrix.msc3401.call",e.GroupCallMemberPrefix="org.matrix.msc3401.call.member",e.CallNotify="org.matrix.msc4075.call.notify",e.RTCNotification="org.matrix.msc4075.rtc.notification",e.RTCDecline="org.matrix.msc4310.rtc.decline",e}({});new n.qr("m.room.purpose","org.matrix.msc3088.purpose"),new n.qr("m.enabled","org.matrix.msc3088.enabled"),new n.qr("m.data_tree","org.matrix.msc3089.data_tree"),new n.qr("m.leaf","org.matrix.msc3089.leaf"),new n.qr("m.branch","org.matrix.msc3089.branch"),new n.qr("m.room.marker","org.matrix.msc2716.marker"),new n.qr("with_rel_types","org.matrix.msc3912.with_relations"),new n.qr("io.element.functional_members","io.element.functional_members"),new n.qr("m.visibility","org.matrix.msc3531.visibility"),new n.qr("enabled","org.matrix.msc3881.enabled"),new n.qr("device_id","org.matrix.msc3881.device_id"),new n.qr("m.local_notification_settings","org.matrix.msc3890.local_notification_settings"),new n.qr("thread_id","org.matrix.msc4023.thread_id"),new n.xu("membership","io.element.msc4115.membership")},"./node_modules/matrix-js-sdk/src/@types/location.ts":(e,t,o)=>{"use strict";var n=o("./node_modules/matrix-js-sdk/src/NamespacedValue.ts");new n.qr("m.asset","org.matrix.msc3488.asset"),new n.qr("m.ts","org.matrix.msc3488.ts"),new n.qr("m.location","org.matrix.msc3488.location")},"./node_modules/matrix-js-sdk/src/@types/read_receipts.ts":(e,t,o)=>{"use strict";o.d(t,{L:()=>n});let n=function(e){return e.Read="m.read",e.FullyRead="m.fully_read",e.ReadPrivate="m.read.private",e}({})},"./node_modules/matrix-js-sdk/src/@types/sync.ts":(e,t,o)=>{"use strict";o.d(t,{a:()=>n});const n=new(o("./node_modules/matrix-js-sdk/src/NamespacedValue.ts").M6)("unread_thread_notifications","org.matrix.msc3773.unread_thread_notifications")},"./node_modules/matrix-js-sdk/src/NamespacedValue.ts":(e,t,o)=>{"use strict";o.d(t,{M6:()=>i,qr:()=>a,xu:()=>s});var n=o("./node_modules/@babel/runtime/helpers/esm/defineProperty.js");class s{constructor(e,t){if(this.stable=e,this.unstable=t,!this.unstable&&!this.stable)throw new Error("One of stable or unstable values must be supplied")}get name(){return this.stable?this.stable:this.unstable}get altName(){return this.stable?this.unstable:null}get names(){const e=[this.name],t=this.altName;return t&&e.push(t),e}matches(e){return this.name===e||this.altName===e}findIn(e){let t;return this.name&&(t=null==e?void 0:e[this.name]),!t&&this.altName&&(t=null==e?void 0:e[this.altName]),t}includedIn(e){let t=!1;return this.name&&(t=e.includes(this.name)),!t&&this.altName&&(t=e.includes(this.altName)),t}}class i extends s{constructor(...e){super(...e),(0,n.A)(this,"preferUnstable",!1)}setPreferUnstable(e){this.preferUnstable=e}get name(){return this.stable&&!this.preferUnstable?this.stable:this.unstable}}class a extends s{constructor(e,t){if(super(e,t),!this.unstable)throw new Error("Unstable value must be supplied")}get name(){return this.unstable}get altName(){return this.stable}}},"./node_modules/matrix-js-sdk/src/indexeddb-worker.ts":(e,t,o)=>{"use strict";o.d(t,{h:()=>a});var n=o("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=o("./node_modules/matrix-js-sdk/src/store/indexeddb-local-backend.ts"),i=o("./node_modules/matrix-js-sdk/src/logger.ts");class a{constructor(e){(0,n.A)(this,"backend",void 0),(0,n.A)(this,"onClose",()=>{this.postMessage.call(null,{command:"closed"})}),(0,n.A)(this,"onMessage",e=>{var t,o,n,a,r,c,l,m,d,u,h,v,p,f,y,g;const b=e.data;let _;switch(b.command){case"setupWorker":this.backend=new s.k(indexedDB,b.args[0]),_=Promise.resolve();break;case"connect":_=null===(t=this.backend)||void 0===t?void 0:t.connect(this.onClose);break;case"isNewlyCreated":_=null===(o=this.backend)||void 0===o?void 0:o.isNewlyCreated();break;case"clearDatabase":_=null===(n=this.backend)||void 0===n?void 0:n.clearDatabase();break;case"getSavedSync":_=null===(a=this.backend)||void 0===a?void 0:a.getSavedSync(!1);break;case"setSyncData":_=null===(r=this.backend)||void 0===r?void 0:r.setSyncData(b.args[0]);break;case"syncToDatabase":_=null===(c=this.backend)||void 0===c?void 0:c.syncToDatabase(b.args[0]);break;case"getUserPresenceEvents":_=null===(l=this.backend)||void 0===l?void 0:l.getUserPresenceEvents();break;case"getNextBatchToken":_=null===(m=this.backend)||void 0===m?void 0:m.getNextBatchToken();break;case"getOutOfBandMembers":_=null===(d=this.backend)||void 0===d?void 0:d.getOutOfBandMembers(b.args[0]);break;case"clearOutOfBandMembers":_=null===(u=this.backend)||void 0===u?void 0:u.clearOutOfBandMembers(b.args[0]);break;case"setOutOfBandMembers":_=null===(h=this.backend)||void 0===h?void 0:h.setOutOfBandMembers(b.args[0],b.args[1]);break;case"getClientOptions":_=null===(v=this.backend)||void 0===v?void 0:v.getClientOptions();break;case"storeClientOptions":_=null===(p=this.backend)||void 0===p?void 0:p.storeClientOptions(b.args[0]);break;case"saveToDeviceBatches":_=null===(f=this.backend)||void 0===f?void 0:f.saveToDeviceBatches(b.args[0]);break;case"getOldestToDeviceBatch":_=null===(y=this.backend)||void 0===y?void 0:y.getOldestToDeviceBatch();break;case"removeToDeviceBatch":_=null===(g=this.backend)||void 0===g?void 0:g.removeToDeviceBatch(b.args[0])}void 0!==_?_.then(e=>{this.postMessage.call(null,{command:"cmd_success",seq:b.seq,result:e})},e=>{i.vF.error("Error running command: "+b.command,e),this.postMessage.call(null,{command:"cmd_fail",seq:b.seq,error:{message:e.message,name:e.name}})}):this.postMessage({command:"cmd_fail",seq:b.seq,error:"Unrecognised command"})}),this.postMessage=e}}},"./node_modules/matrix-js-sdk/src/logger.ts":(e,t,o)=>{"use strict";o.d(t,{vF:()=>i});var n=o("./node_modules/loglevel/lib/loglevel.js"),s=o.n(n);s().methodFactory=function(e,t,o){return function(...t){this.prefix&&t.unshift(this.prefix);return"error"===e||"warn"===e||"trace"===e||"info"===e||"debug"===e?console[e](...t):console.log(...t)}};const i=function e(t){const o="matrix"+(void 0===t?"":`-${t}`),n=s().getLogger(o);return void 0===n.getChild&&(n.prefix=t,n.getChild=o=>{const s=e((null!=t?t:"")+o);return s.methodFactory=n.methodFactory,s.rebuild(),s},n.setLevel(s().levels.DEBUG,!1)),n}()},"./node_modules/matrix-js-sdk/src/sync-accumulator.ts":(e,t,o)=>{"use strict";o.d(t,{w:()=>m});var n=o("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=o("./node_modules/matrix-js-sdk/src/logger.ts"),i=o("./node_modules/matrix-js-sdk/src/utils.ts"),a=o("./node_modules/matrix-js-sdk/src/@types/sync.ts"),r=o("./node_modules/matrix-js-sdk/src/@types/event.ts");class c{constructor(){(0,n.A)(this,"unthreadedReadReceipts",new Map),(0,n.A)(this,"threadedReadReceipts",new i.kG(()=>new Map))}setUnthreaded(e,t){this.unthreadedReadReceipts.set(e,t)}setThreaded(e,t,o){this.threadedReadReceipts.getOrCreate(e).set(t,o)}allUnthreaded(){return this.unthreadedReadReceipts.entries()}*allThreaded(){for(const e of this.threadedReadReceipts.values())for(const t of e.entries())yield t}consumeEphemeralEvents(e){null==e||e.forEach(e=>{e.type===r.Bx.Receipt&&e.content&&Object.keys(e.content).forEach(t=>{Object.entries(e.content[t]).forEach(([o,n])=>{if((0,i.ll)(o))for(const s of Object.keys(n)){const n=e.content[t][o][s],i={data:e.content[t][o][s],type:o,eventId:t};n.thread_id?this.setThreaded(n.thread_id,s,i):this.setUnthreaded(s,i)}})})})}buildAccumulatedReceiptEvent(e){const t={type:r.Bx.Receipt,room_id:e,content:{}},o=new i.kG(()=>new i.kG(()=>new Map));for(const[e,t]of this.allUnthreaded())o.getOrCreate(t.eventId).getOrCreate(t.type).set(e,t.data);for(const[e,t]of this.allThreaded())o.getOrCreate(t.eventId).getOrCreate(t.type).set(e,t.data);return t.content=(0,i.HF)(o),o.size>0?t:null}}let l=function(e){return e.Invite="invite",e.Leave="leave",e.Join="join",e.Knock="knock",e}({});class m{constructor(e={}){(0,n.A)(this,"accountData",{}),(0,n.A)(this,"inviteRooms",{}),(0,n.A)(this,"knockRooms",{}),(0,n.A)(this,"joinRooms",{}),(0,n.A)(this,"nextBatch",null),this.opts=e,this.opts.maxTimelineEntries=this.opts.maxTimelineEntries||50}accumulate(e,t=!1){this.accumulateRooms(e,t),this.accumulateAccountData(e),this.nextBatch=e.next_batch}accumulateAccountData(e){e.account_data&&e.account_data.events&&e.account_data.events.forEach(e=>{this.accountData[e.type]=e})}accumulateRooms(e,t=!1){e.rooms&&(e.rooms.invite&&Object.keys(e.rooms.invite).forEach(o=>{this.accumulateRoom(o,l.Invite,e.rooms.invite[o],t)}),e.rooms.join&&Object.keys(e.rooms.join).forEach(o=>{this.accumulateRoom(o,l.Join,e.rooms.join[o],t)}),e.rooms.leave&&Object.keys(e.rooms.leave).forEach(o=>{this.accumulateRoom(o,l.Leave,e.rooms.leave[o],t)}),e.rooms.knock&&Object.keys(e.rooms.knock).forEach(o=>{this.accumulateRoom(o,l.Knock,e.rooms.knock[o],t)}))}accumulateRoom(e,t,o,n=!1){switch(t){case l.Invite:this.knockRooms[e]&&delete this.knockRooms[e],this.accumulateInviteState(e,o);break;case l.Knock:this.accumulateKnockState(e,o);break;case l.Join:this.knockRooms[e]?delete this.knockRooms[e]:this.inviteRooms[e]&&delete this.inviteRooms[e],this.accumulateJoinState(e,o,n);break;case l.Leave:this.knockRooms[e]?delete this.knockRooms[e]:this.inviteRooms[e]?delete this.inviteRooms[e]:delete this.joinRooms[e];break;default:s.vF.error("Unknown cateogory: ",t)}}accumulateInviteState(e,t){if(!t.invite_state||!t.invite_state.events)return;if(!this.inviteRooms[e])return void(this.inviteRooms[e]={invite_state:t.invite_state});const o=this.inviteRooms[e];t.invite_state.events.forEach(e=>{let t=!1;for(let n=0;n<o.invite_state.events.length;n++){const s=o.invite_state.events[n];s.type===e.type&&s.state_key==e.state_key&&(o.invite_state.events[n]=e,t=!0)}t||o.invite_state.events.push(e)})}accumulateKnockState(e,t){if(!t.knock_state||!t.knock_state.events)return;if(!this.knockRooms[e])return void(this.knockRooms[e]={knock_state:t.knock_state});const o=this.knockRooms[e];t.knock_state.events.forEach(e=>{let t=!1;for(let n=0;n<o.knock_state.events.length;n++){const s=o.knock_state.events[n];s.type===e.type&&s.state_key==e.state_key&&(o.knock_state.events[n]=e,t=!0)}t||o.knock_state.events.push(e)})}accumulateJoinState(e,t,o=!1){var n,s,i,r,l,m;this.joinRooms[e]||(this.joinRooms[e]={_currentState:Object.create(null),_timeline:[],_accountData:Object.create(null),_unreadNotifications:{},_unreadThreadNotifications:{},_summary:{},_receipts:new c});const u=this.joinRooms[e];if(t.account_data&&t.account_data.events&&t.account_data.events.forEach(e=>{u._accountData[e.type]=e}),t.unread_notifications&&(u._unreadNotifications=t.unread_notifications),u._unreadThreadNotifications=null!==(n=null!==(s=t[a.a.stable])&&void 0!==s?s:t[a.a.unstable])&&void 0!==n?n:void 0,t.summary){var h,v,p;const e="m.heroes",o="m.invited_member_count",n="m.joined_member_count",s=u._summary,i=t.summary;s[e]=null!==(h=i[e])&&void 0!==h?h:s[e],s[n]=null!==(v=i[n])&&void 0!==v?v:s[n],s[o]=null!==(p=i[o])&&void 0!==p?p:s[o]}if(u._receipts.consumeEphemeralEvents(null===(i=t.ephemeral)||void 0===i?void 0:i.events),t.timeline&&t.timeline.limited&&(u._timeline=[]),null===(r=t.state)||void 0===r||null===(r=r.events)||void 0===r||r.forEach(e=>{d(u._currentState,e)}),null===(l=t["org.matrix.msc4222.state_after"])||void 0===l||null===(l=l.events)||void 0===l||l.forEach(e=>{d(u._currentState,e)}),null===(m=t.timeline)||void 0===m||null===(m=m.events)||void 0===m||m.forEach((e,n)=>{var s;let i;if(t["org.matrix.msc4222.state_after"]||d(u._currentState,e),o)i=e;else{var a;i=Object.assign({},e),void 0!==i.unsigned&&(i.unsigned=Object.assign({},i.unsigned));const t=null===(a=e.unsigned)||void 0===a?void 0:a.age;void 0!==t&&(i._localTs=Date.now()-t)}u._timeline.push({event:i,token:0===n&&null!==(s=t.timeline.prev_batch)&&void 0!==s?s:null})}),u._timeline.length>this.opts.maxTimelineEntries){for(let e=u._timeline.length-this.opts.maxTimelineEntries;e<u._timeline.length;e++)if(u._timeline[e].token){u._timeline=u._timeline.slice(e,u._timeline.length);break}}}getJSON(e=!1){const t={join:{},invite:{},knock:{},leave:{}};Object.keys(this.inviteRooms).forEach(e=>{t.invite[e]=this.inviteRooms[e]}),Object.keys(this.knockRooms).forEach(e=>{t.knock[e]=this.knockRooms[e]}),Object.keys(this.joinRooms).forEach(o=>{const n=this.joinRooms[o],s={ephemeral:{events:[]},account_data:{events:[]},state:{events:[]},"org.matrix.msc4222.state_after":{events:[]},timeline:{events:[],prev_batch:null},unread_notifications:n._unreadNotifications,unread_thread_notifications:n._unreadThreadNotifications,summary:n._summary};Object.keys(n._accountData).forEach(e=>{s.account_data.events.push(n._accountData[e])});const a=n._receipts.buildAccumulatedReceiptEvent(o);a&&s.ephemeral.events.push(a),n._timeline.forEach(t=>{if(!s.timeline.prev_batch){if(!t.token)return;s.timeline.prev_batch=t.token}let o;var n;!e&&("_localTs"in(n=t.event)&&void 0!==n._localTs)?(o=Object.assign({},t.event),void 0!==o.unsigned&&(o.unsigned=Object.assign({},o.unsigned)),delete o._localTs,o.unsigned=o.unsigned||{},o.unsigned.age=Date.now()-t.event._localTs):o=t.event,s.timeline.events.push(o)});const r=Object.create(null);for(let e=s.timeline.events.length-1;e>=0;e--){const t=s.timeline.events[e];if(null===t.state_key||void 0===t.state_key)continue;const o=(0,i.A4)(t);o.unsigned&&(o.unsigned.prev_content&&(o.content=o.unsigned.prev_content),o.unsigned.prev_sender&&(o.sender=o.unsigned.prev_sender)),d(r,o)}Object.keys(n._currentState).forEach(e=>{Object.keys(n._currentState[e]).forEach(t=>{let o=n._currentState[e][t];s["org.matrix.msc4222.state_after"].events.push(o),r[e]&&r[e][t]&&(o=r[e][t]),s.state.events.push(o)})}),t.join[o]=s});const o=[];return Object.keys(this.accountData).forEach(e=>{o.push(this.accountData[e])}),{nextBatch:this.nextBatch,roomsData:t,accountData:o}}getNextBatchToken(){return this.nextBatch}}function d(e,t){null!==t.state_key&&void 0!==t.state_key&&t.type&&(e[t.type]||(e[t.type]=Object.create(null)),e[t.type][t.state_key]=t)}},"./node_modules/matrix-js-sdk/src/utils.ts":(e,t,o)=>{"use strict";o.d(t,{A4:()=>s,HF:()=>c,j0:()=>i,kG:()=>l,ll:()=>a});o("./node_modules/unhomoglyph/index.js"),o("./node_modules/matrix-js-sdk/src/@types/location.ts");var n=o("./node_modules/matrix-js-sdk/src/@types/read_receipts.ts");new Map;function s(e){return JSON.parse(JSON.stringify(e))}function i(e){return Promise.resolve(e())}(()=>{let e="";for(let t=32;t<=126;t++)e+=String.fromCharCode(t)})();function a(e){return[n.L.Read,n.L.ReadPrivate].includes(e)}function r(e){return e instanceof Map?c(e):Array.isArray(e)?e.map(e=>r(e)):e}function c(e){const t=new Map;for(const[o,n]of e)t.set(o,r(n));return Object.fromEntries(t.entries())}class l extends Map{constructor(e){super(),this.createDefault=e}getOrCreate(e){return this.has(e)||this.set(e,this.createDefault()),this.get(e)}}},"./node_modules/unhomoglyph/index.js":(e,t,o)=>{"use strict";var n=o("./node_modules/unhomoglyph/data.json");var s=RegExp(Object.keys(n).map(function(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}).join("|"),"g");function i(e){return n[e]}e.exports=function(e){return e.replace(s,i)}}}]);
//# sourceMappingURL=6063.js.map