"use strict";(self.webpackChunkelement_web=self.webpackChunkelement_web||[]).push([[7766],{"./src/components/views/location/LocationButton.tsx":(e,t,o)=>{o.r(t),o.d(t,{default:()=>ie});var n=o("./node_modules/react/index.js"),s=o("./node_modules/classnames/index.js"),i=o.n(s),r=o("./src/languageHandler.tsx"),a=o("./src/components/views/rooms/CollapsibleButton.tsx"),l=o("./src/components/structures/ContextMenu.tsx"),c=o("./src/components/views/rooms/MessageComposerButtons.tsx"),m=o("./node_modules/@babel/runtime/helpers/esm/extends.js"),u=o("./src/contexts/MatrixClientContext.tsx"),d=o("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),p=o("./node_modules/maplibre-gl/dist/maplibre-gl.js"),_=o.n(p),h=o("./node_modules/matrix-js-sdk/src/logger.ts"),g=o("./node_modules/matrix-js-sdk/src/matrix.ts"),v=o("./src/Modal.tsx"),x=o("./src/utils/WellKnownUtils.ts"),C=o("./src/utils/beacon/index.ts"),k=o("./src/utils/location/index.ts"),E=o("./src/components/views/dialogs/ErrorDialog.tsx"),b=o("./src/components/views/elements/AccessibleButton.tsx"),y=o("./src/components/views/location/MapError.tsx"),M=o("./src/DateUtils.ts"),A=o("./src/components/views/elements/Dropdown.tsx");const w={fifteenMins:9e5,oneHour:36e5,eightHours:288e5},f=w.fifteenMins,S=e=>(0,r._t)("location_sharing|live_share_button",{duration:(0,M.a3)(e)}),N=({timeout:e,onChange:t})=>{const o=Object.values(w).map(e=>({key:e.toString(),duration:e,label:S(e)}));Object.values(w).includes(e)||o.push({key:e.toString(),duration:e,label:S(e)});return n.createElement(A.A,{id:"live-duration",label:S(e),value:e.toString(),onOptionChange:e=>{t(+e)},className:"mx_LiveDurationDropdown"},o.map(({key:e,label:t})=>n.createElement("div",{key:e},t)))};var L=o("./src/components/views/dialogs/QuestionDialog.tsx"),T=o("./src/SdkConfig.ts"),P=o("./src/stores/OwnBeaconStore.ts"),B=o("./src/utils/local-room.ts");let j=function(e){return e.Own="Own",e.Pin="Pin",e.Live="Live",e}({});const F=(e,t,o)=>{const{modalParams:n,errorMessage:s}="M_FORBIDDEN"===e.errcode?(e=>{const t=e===j.Live?"Insufficient permissions to start sharing your live location":"Insufficient permissions to send your location";return{modalParams:{title:(0,r._t)("location_sharing|error_no_perms_title"),description:(0,r._t)("location_sharing|error_no_perms_description"),button:(0,r._t)("action|ok"),hasCancelButton:!1,onFinished:()=>{}},errorMessage:t}})(o):((e,t)=>{const o=e===j.Live?"We couldn't start sharing your live location":"We couldn't send your location";return{modalParams:{title:(0,r._t)("location_sharing|error_send_title"),description:(0,r._t)("location_sharing|error_send_description",{brand:T.Ay.get().brand}),button:(0,r._t)("action|try_again"),cancelButton:(0,r._t)("action|cancel"),onFinished:e=>{e&&t()}},errorMessage:o}})(o,t);h.vF.error(s,e),v.Ay.createDialog(L.A,n)};var I=o("./src/components/views/location/Marker.tsx");const R=e=>e===j.Own||e===j.Live;class O extends n.Component{constructor(e){super(e),(0,d.A)(this,"map",void 0),(0,d.A)(this,"geolocate",void 0),(0,d.A)(this,"marker",void 0),(0,d.A)(this,"getMarkerId",()=>"mx_MLocationPicker_marker"),(0,d.A)(this,"addMarkerToMap",()=>{var e;this.marker=new(_().Marker)({element:null!==(e=document.getElementById(this.getMarkerId()))&&void 0!==e?e:void 0,anchor:"bottom",offset:[0,-1]}).setLngLat(new(_().LngLat)(0,0)).addTo(this.map)}),(0,d.A)(this,"updateStyleUrl",e=>{var t;const o=null===(t=(0,x.XP)(e))||void 0===t?void 0:t.map_style_url;var n;o&&(null===(n=this.map)||void 0===n||n.setStyle(o))}),(0,d.A)(this,"onGeolocate",e=>{var t;this.marker||this.addMarkerToMap(),this.setState({position:(0,C.v9)(e)}),null===(t=this.marker)||void 0===t||t.setLngLat(new(_().LngLat)(e.coords.longitude,e.coords.latitude))}),(0,d.A)(this,"onClick",e=>{var t;this.marker||this.addMarkerToMap(),null===(t=this.marker)||void 0===t||t.setLngLat(e.lngLat),this.setState({position:{timestamp:Date.now(),latitude:e.lngLat.lat,longitude:e.lngLat.lng}})}),(0,d.A)(this,"onGeolocateError",e=>{var t;(h.vF.error("Could not fetch location",e),R(this.props.shareType)&&(this.props.onFinished(),v.Ay.createDialog(E.A,{title:(0,r._t)("location_sharing|error_fetch_location"),description:(0,k.Ff)(e.code)})),this.geolocate)&&(null===(t=this.map)||void 0===t||t.removeControl(this.geolocate))}),(0,d.A)(this,"onTimeoutChange",e=>{this.setState({timeout:e})}),(0,d.A)(this,"onOk",()=>{const{timeout:e,position:t}=this.state;this.props.onChoose(t?{uri:(0,C.mt)(t),timestamp:t.timestamp,timeout:e}:{timeout:e}),this.props.onFinished()}),this.state={position:void 0,timeout:f,error:void 0}}componentDidMount(){this.context.on(g.ClientEvent.ClientWellKnown,this.updateStyleUrl);try{if(this.map=new(_().Map)({container:"mx_LocationPicker_map",style:(0,k.M0)(this.context),center:[0,0],zoom:1}),this.geolocate=new(_().GeolocateControl)({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!1}),this.map.addControl(this.geolocate),this.map.on("error",e=>{h.vF.error("Failed to load map: check map_style_url in config.json has a valid URL and API key",e.error),this.setState({error:k.$X.MapStyleUrlNotReachable})}),this.map.on("load",()=>{var e;null===(e=this.geolocate)||void 0===e||e.trigger()}),this.geolocate.on("error",this.onGeolocateError),R(this.props.shareType)&&this.geolocate.on("geolocate",this.onGeolocate),this.props.shareType===j.Pin){const e=new(_().NavigationControl)({showCompass:!1,showZoom:!0});this.map.addControl(e,"bottom-right"),this.map.on("click",this.onClick)}}catch(e){h.vF.error("Failed to render map",e);const t=null==e?void 0:e.message;let o;o=t===k.$X.MapStyleUrlNotConfigured?k.$X.MapStyleUrlNotConfigured:t.includes("Failed to initialize WebGL")?k.$X.WebGLNotEnabled:k.$X.Default,this.setState({error:o})}}componentWillUnmount(){var e,t,o;null===(e=this.geolocate)||void 0===e||e.off("error",this.onGeolocateError),null===(t=this.geolocate)||void 0===t||t.off("geolocate",this.onGeolocate),null===(o=this.map)||void 0===o||o.off("click",this.onClick),this.context.off(g.ClientEvent.ClientWellKnown,this.updateStyleUrl)}render(){return this.state.error?n.createElement("div",{className:"mx_LocationPicker mx_LocationPicker_hasError"},n.createElement(y.p,{error:this.state.error,onFinished:this.props.onFinished})):n.createElement("div",{className:"mx_LocationPicker"},n.createElement("div",{id:"mx_LocationPicker_map"}),this.props.shareType===j.Pin&&n.createElement("div",{className:"mx_LocationPicker_pinText"},n.createElement("span",null,this.state.position?(0,r._t)("location_sharing|click_move_pin"):(0,r._t)("location_sharing|click_drop_pin"))),n.createElement("div",{className:"mx_LocationPicker_footer"},n.createElement("form",{onSubmit:this.onOk},this.props.shareType===j.Live&&n.createElement(N,{onChange:this.onTimeoutChange,timeout:this.state.timeout}),n.createElement(b.A,{type:"submit",element:"button",kind:"primary",className:"mx_LocationPicker_submitButton",disabled:!this.state.position,onClick:this.onOk},(0,r._t)("location_sharing|share_button")))),n.createElement("div",{id:this.getMarkerId()},!!this.marker&&n.createElement(I.A,{roomMember:R(this.props.shareType)?this.props.sender:void 0,useMemberColor:this.props.shareType===j.Live})))}}(0,d.A)(O,"contextType",u.Ay);const D=O;var U=o("./src/settings/SettingsStore.ts"),H=o("./node_modules/@vector-im/compound-design-tokens/assets/web/icons/close.js"),G=o("./node_modules/@vector-im/compound-design-tokens/assets/web/icons/chevron-left.js");const W=({onBack:e,onCancel:t,displayBack:o})=>n.createElement("div",{className:"mx_ShareDialogButtons"},o&&n.createElement(b.A,{className:"mx_ShareDialogButtons_button left","aria-label":(0,r._t)("action|back"),onClick:e,element:"button"},n.createElement(G.A,{className:"mx_ShareDialogButtons_button-icon"})),n.createElement(b.A,{className:"mx_ShareDialogButtons_button right","aria-label":(0,r._t)("action|close"),onClick:t,element:"button"},n.createElement(H.A,{className:"mx_ShareDialogButtons_button-icon"})));var J=o("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),$=o("./node_modules/@vector-im/compound-design-tokens/assets/web/icons/location-pin-solid.js"),z=o("./src/stores/OwnProfileStore.ts"),X=o("./src/components/views/avatars/BaseAvatar.tsx"),V=o("./src/components/views/typography/Heading.tsx"),Z=o("./src/components/views/beacon/StyledLiveBeaconIcon.tsx");const q=["onClick","label","shareType"],Y=()=>{var e,t;const o=(0,n.useContext)(u.Ay).getSafeUserId(),s=null!==(e=z.V.instance.displayName)&&void 0!==e?e:void 0,i="36px",r=null!==(t=z.V.instance.getHttpAvatarUrl(parseInt(i,10)))&&void 0!==t?t:void 0;return n.createElement("div",{className:`mx_ShareType_option-icon ${j.Own}`},n.createElement(X.A,{idName:o,name:s,url:r,size:i,className:"mx_UserMenu_userAvatar_BaseAvatar"}))},K=e=>{let{onClick:t,label:o,shareType:s}=e,i=(0,J.A)(e,q);return n.createElement(b.A,(0,m.A)({element:"button",className:"mx_ShareType_option",onClick:null!=t?t:null},i),s===j.Own&&n.createElement(Y,null),s===j.Pin&&n.createElement($.A,{className:`mx_ShareType_option-icon ${j.Pin}`}),s===j.Live&&n.createElement(Z.A,{className:`mx_ShareType_option-icon ${j.Live}`}),o)},Q=({setShareType:e,enabledShareTypes:t})=>{const o={[j.Own]:(0,r._t)("location_sharing|share_type_own"),[j.Live]:(0,r._t)("location_sharing|share_type_live"),[j.Pin]:(0,r._t)("location_sharing|share_type_pin")};return n.createElement("div",{className:"mx_ShareType"},n.createElement($.A,{className:"mx_ShareType_badge"}),n.createElement(V.A,{className:"mx_ShareType_heading",size:"3"},(0,r._t)("location_sharing|share_type_prompt")),n.createElement("div",{className:"mx_ShareType_wrapper_options"},t.map(t=>n.createElement(K,{key:t,onClick:()=>e(t),label:o[t],shareType:t}))))};var ee=o("./src/components/views/elements/LabelledToggleSwitch.tsx");const te=({onSubmit:e})=>{const[t,o]=(0,n.useState)(!1);return n.createElement("div",{className:"mx_EnableLiveShare"},n.createElement(Z.A,{className:"mx_EnableLiveShare_icon"}),n.createElement(V.A,{className:"mx_EnableLiveShare_heading",size:"3"},(0,r._t)("location_sharing|live_enable_heading")),n.createElement("p",{className:"mx_EnableLiveShare_description"},(0,r._t)("location_sharing|live_enable_description")),n.createElement(ee.A,{value:t,onChange:o,label:(0,r._t)("location_sharing|live_toggle_label")}),n.createElement(b.A,{className:"mx_EnableLiveShare_button",element:"button",kind:"primary",onClick:e,disabled:!t},(0,r._t)("action|ok")))};var oe=o("./src/hooks/useSettings.ts"),ne=o("./src/settings/SettingLevel.ts");const se=({menuPosition:e,onFinished:t,sender:o,roomId:s,openMenu:i,relation:a})=>{const c=(0,n.useContext)(u.Ay),d=(e=>{const t=[j.Own];return e||t.push(j.Live),t.push(j.Pin),t})(a),p=(0,oe.ny)("feature_location_share_live"),_=d.length>1,[h,v]=(0,n.useState)(_?void 0:j.Own),x=z.V.instance.displayName,C=c.getSafeUserId(),k=h===j.Live?((e,t,o,n)=>async({timeout:e})=>{const s=(0,r._t)("location_sharing|live_description",{displayName:o});try{await P.g.instance.createLiveBeacon(t,g.ContentHelpers.makeBeaconInfoContent(null!=e?e:3e5,!0,s,g.LocationAssetType.Self))}catch(e){F(e,n,j.Live)}})(0,s,x||C,i):((e,t,o,n,s)=>async({uri:i,timestamp:r})=>{if(i)try{const s=(null==n?void 0:n.rel_type)===g.THREAD_RELATION_TYPE.name&&(null==n?void 0:n.event_id)||null,a=o===j.Pin?g.LocationAssetType.Pin:g.LocationAssetType.Self,l=g.ContentHelpers.makeLocationContent(void 0,i,r,void 0,a);await(0,B.Y)(t,t=>e.sendMessage(t,s,l),e)}catch(e){F(e,s,o)}})(c,s,null!=h?h:j.Own,a,i),E=h===j.Live&&!p;return n.createElement(l.Ay,(0,m.A)({},e,{onFinished:t,managed:!1}),n.createElement("div",{className:"mx_LocationShareMenu"},E&&n.createElement(te,{onSubmit:()=>{U.A.setValue("feature_location_share_live",null,ne.p.DEVICE,!0)}}),!E&&!!h&&n.createElement(D,{sender:o,shareType:h,onChoose:k,onFinished:t}),!h&&n.createElement(Q,{setShareType:v,enabledShareTypes:d}),n.createElement(W,{displayBack:!!h&&_,onBack:()=>v(void 0),onCancel:t})))},ie=({roomId:e,sender:t,menuPosition:o,relation:s})=>{const m=(0,n.useContext)(c.ZF),[u,d,p,_]=(0,l.EF)(),h=e=>{_(e),null==m||m()};let g=null;if(u){var v;const i=null!==(v=null!=o?o:d.current&&(0,l.qv)(d.current.getBoundingClientRect()))&&void 0!==v?v:{};g=n.createElement(se,{menuPosition:i,onFinished:h,sender:t,roomId:e,openMenu:p,relation:s})}const x=i()("mx_MessageComposer_button",{mx_MessageComposer_button_highlight:u});return n.createElement(n.Fragment,null,n.createElement(a.J,{className:x,iconClassName:"mx_MessageComposer_location",onClick:p,title:(0,r._t)("common|location"),inputRef:d}),g)}},"./src/components/views/location/Marker.tsx":(e,t,o)=>{o.d(t,{A:()=>m});var n=o("./node_modules/react/index.js"),s=o("./node_modules/classnames/index.js"),i=o.n(s),r=o("./node_modules/@vector-im/compound-design-tokens/assets/web/icons/location-pin-solid.js"),a=o("./src/utils/FormattingUtils.ts"),l=o("./src/components/views/avatars/MemberAvatar.tsx");const c=({tooltip:e,children:t})=>{const[o,s]=(0,n.useState)(!1);if(!e)return n.createElement(n.Fragment,null,t);return n.createElement("div",{onMouseEnter:()=>s(!0),onClick:e=>{e.stopPropagation(),s(!o)},onMouseLeave:()=>s(!1)},t,o&&e)},m=({id:e,roomMember:t,useMemberColor:o,tooltip:s,ref:m})=>{const u=o&&t?(0,a.yJ)(t.userId):"";return n.createElement("div",{ref:m,id:e,className:i()("mx_Marker",u,{mx_Marker_defaultColor:!u})},n.createElement(c,{tooltip:s},n.createElement("div",{className:"mx_Marker_border"},t?n.createElement(l.A,{member:t,size:"36px",viewUserOnClick:!1,hideTitle:!!s}):n.createElement(r.A,{className:"mx_Marker_icon"}))))}},"./src/components/views/rooms/CollapsibleButton.tsx":(e,t,o)=>{o.d(t,{J:()=>d});var n=o("./node_modules/@babel/runtime/helpers/esm/extends.js"),s=o("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),i=o("./node_modules/react/index.js"),r=o("./node_modules/classnames/index.js"),a=o.n(r),l=o("./src/components/views/elements/AccessibleButton.tsx"),c=o("./src/components/views/rooms/MessageComposerButtons.tsx"),m=o("./src/components/views/context_menus/IconizedContextMenu.tsx");const u=["title","children","className","iconClassName","inputRef"],d=e=>{let{title:t,children:o,className:r,iconClassName:d,inputRef:p}=e,_=(0,s.A)(e,u);return!!(0,i.useContext)(c.ZF)?i.createElement(m.R$,(0,n.A)({},_,{iconClassName:d,label:t,inputRef:p})):i.createElement(l.A,(0,n.A)({},_,{title:t,className:a()(r,d),ref:p}),o)}},"./src/components/views/rooms/EmojiButton.tsx":(e,t,o)=>{o.d(t,{h:()=>d});var n=o("./node_modules/@babel/runtime/helpers/esm/extends.js"),s=o("./node_modules/classnames/index.js"),i=o.n(s),r=o("./node_modules/react/index.js"),a=o("./src/languageHandler.tsx"),l=o("./src/components/structures/ContextMenu.tsx"),c=o("./src/components/views/emojipicker/EmojiPicker.tsx"),m=o("./src/components/views/rooms/CollapsibleButton.tsx"),u=o("./src/components/views/rooms/MessageComposerButtons.tsx");function d({addEmoji:e,menuPosition:t,className:o}){const s=(0,r.useContext)(u.ZF),[d,p,_,h]=(0,l.EF)();let g=null;if(d&&p.current){const o=null!=t?t:(0,l.qv)(p.current.getBoundingClientRect()),i=()=>{h(),null==s||s()};g=r.createElement(l.Ay,(0,n.A)({},o,{onFinished:i,managed:!1}),r.createElement(c.Ay,{onChoose:e,onFinished:i}))}const v=i()("mx_EmojiButton",o,{mx_EmojiButton_highlight:d});return r.createElement(r.Fragment,null,r.createElement(m.J,{className:v,iconClassName:"mx_EmojiButton_icon",onClick:_,title:(0,a._t)("common|emoji"),inputRef:p}),g)}},"./src/components/views/rooms/MessageComposerButtons.tsx":(e,t,o)=>{o.d(t,{Ay:()=>D,ZF:()=>f});var n=o("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=o("./node_modules/@babel/runtime/helpers/esm/extends.js"),i=o("./node_modules/classnames/index.js"),r=o.n(i),a=o("./node_modules/matrix-js-sdk/src/matrix.ts"),l=o("./node_modules/react/index.js"),c=o("./src/languageHandler.tsx"),m=o("./src/components/views/rooms/CollapsibleButton.tsx"),u=o("./src/dispatcher/dispatcher.ts"),d=o("./src/components/views/dialogs/ErrorDialog.tsx"),p=o("./src/components/views/location/index.tsx"),_=o("./src/Modal.tsx"),h=o("./src/components/views/elements/PollCreateDialog.tsx"),g=o("./src/MatrixClientPeg.ts"),v=o("./src/ContentMessages.ts"),x=o("./src/contexts/MatrixClientContext.tsx"),C=o("./src/hooks/useDispatcher.ts"),k=o("./src/utils/BrowserWorkarounds.ts"),E=o("./src/components/views/context_menus/IconizedContextMenu.tsx"),b=o("./src/components/views/rooms/EmojiButton.tsx"),y=o("./src/utils/arrays.ts"),M=o("./src/hooks/useSettings.ts"),A=o("./src/components/views/elements/AccessibleButton.tsx"),w=o("./src/contexts/ScopedRoomContext.tsx");const f=(0,l.createContext)(null);function S(e){return l.createElement(b.h,{key:"emoji_button",addEmoji:e.addEmoji,menuPosition:e.menuPosition,className:"mx_MessageComposer_button"})}function N(){return l.createElement(P,{key:"controls_upload"})}const L=(0,l.createContext)(null),T=({roomId:e,relation:t,children:o})=>{const n=(0,l.useContext)(x.Ay),s=(0,w.ME)("timelineRenderingType"),i=(0,l.useRef)(null),r=()=>{var e;null!=n&&n.isGuest()?u.A.dispatch({action:"require_registration"}):null===(e=i.current)||void 0===e||e.click()};(0,C.F)(u.A,e=>{s.timelineRenderingType===e.context&&"upload_file"===e.action&&r()});return l.createElement(L.Provider,{value:r},o,l.createElement("input",{ref:i,type:"file",style:{display:"none"},multiple:!0,onClick:k.e,onChange:o=>{var i;0!==(null===(i=o.target.files)||void 0===i?void 0:i.length)&&(v.Ay.sharedInstance().sendContentListToRoom(Array.from(o.target.files),e,t,n,s.timelineRenderingType),o.target.value="")}}))},P=()=>{const e=(0,l.useContext)(f),t=(0,l.useContext)(L);return l.createElement(m.J,{className:"mx_MessageComposer_button",iconClassName:"mx_MessageComposer_upload",onClick:()=>{null==t||t(),null==e||e()},title:(0,c._t)("common|attachment")})};function B(e){return e.showStickersButton?l.createElement(m.J,{id:"stickersButton",key:"controls_stickers",className:"mx_MessageComposer_button",iconClassName:"mx_MessageComposer_stickers",onClick:()=>e.setStickerPickerOpen(!e.isStickerPickerOpen),title:e.isStickerPickerOpen?(0,c._t)("composer|close_sticker_picker"):(0,c._t)("common|sticker")}):null}function j(e,t){return t?null:l.createElement(m.J,{key:"voice_message_send",className:"mx_MessageComposer_button",iconClassName:"mx_MessageComposer_voiceMessage",onClick:e.onRecordStartEndClick,title:(0,c._t)("composer|voice_message_button")})}function F(e,t){return l.createElement(I,{key:"polls",room:e,relation:t})}class I extends l.PureComponent{constructor(...e){super(...e),(0,n.A)(this,"onCreateClick",()=>{var e;null===(e=this.context)||void 0===e||e.call(this);if(this.props.room.currentState.maySendEvent(a.M_POLL_START.name,g.J.safeGet().getSafeUserId())){var t;const e=(null===(t=this.props.relation)||void 0===t?void 0:t.rel_type)===a.THREAD_RELATION_TYPE.name?this.props.relation.event_id:void 0;_.Ay.createDialog(h.A,{room:this.props.room,threadId:e},"mx_CompoundDialog",!1,!0)}else _.Ay.createDialog(d.A,{title:(0,c._t)("composer|poll_button_no_perms_title"),description:(0,c._t)("composer|poll_button_no_perms_description")})})}render(){var e;return(null===(e=this.props.relation)||void 0===e?void 0:e.rel_type)===a.THREAD_RELATION_TYPE.name?null:l.createElement(m.J,{className:"mx_MessageComposer_button",iconClassName:"mx_MessageComposer_poll",onClick:this.onCreateClick,title:(0,c._t)("composer|poll_button")})}}function R(e,t,o){const n=t.getMember(o.getSafeUserId());return e.showLocationButton&&n?l.createElement(p.Uo,{key:"location",roomId:t.roomId,relation:e.relation,sender:n,menuPosition:e.menuPosition}):null}function O({isRichTextEnabled:e,onClick:t}){const o=e?(0,c._t)("composer|mode_plain"):(0,c._t)("composer|mode_rich_text");return l.createElement(m.J,{className:"mx_MessageComposer_button",iconClassName:r()({mx_MessageComposer_plain_text:!e,mx_MessageComposer_rich_text:e}),onClick:t,title:o})}(0,n.A)(I,"contextType",f);const D=e=>{const t=(0,l.useContext)(x.Ay),{room:o,narrow:n}=(0,w.ME)("room","narrow"),i=(0,M.ti)("feature_wysiwyg_composer");if(!t||!o||e.haveRecording)return null;let a,m;n?(a=[i?l.createElement(O,{key:"composerModeButton",isRichTextEnabled:e.isRichTextEnabled,onClick:e.onComposerModeClick}):S(e)],m=[N(),B(e),j(e,n),e.showPollsButton?F(o,e.relation):null,R(e,o,t)]):(a=[i?l.createElement(O,{key:"composerModeButton",isRichTextEnabled:e.isRichTextEnabled,onClick:e.onComposerModeClick}):S(e),N()],m=[B(e),j(e,n),e.showPollsButton?F(o,e.relation):null,R(e,o,t)]),a=(0,y.Bo)(a),m=(0,y.Bo)(m);const u=r()({mx_MessageComposer_button:!0,mx_MessageComposer_buttonMenu:!0,mx_MessageComposer_closeButtonMenu:e.isMenuOpen});return l.createElement(T,{roomId:o.roomId,relation:e.relation},a,m.length>0&&l.createElement(A.A,{className:u,onClick:e.toggleButtonMenu,title:(0,c._t)("quick_settings|sidebar_settings")}),e.isMenuOpen&&l.createElement(E.Ay,(0,s.A)({onFinished:e.toggleButtonMenu},e.menuPosition,{wrapperClassName:"mx_MessageComposer_Menu",compact:!0}),l.createElement(f.Provider,{value:e.toggleButtonMenu},l.createElement(E.tx,null,m))))}}}]);
//# sourceMappingURL=7766.js.map