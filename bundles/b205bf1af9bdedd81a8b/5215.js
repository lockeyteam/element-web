"use strict";(self.webpackChunkelement_web=self.webpackChunkelement_web||[]).push([[5215],{"./node_modules/@vector-im/compound-design-tokens/assets/web/icons/mic-on-solid.js":(e,t,o)=>{o.d(t,{A:()=>l});var n=o("./node_modules/react/index.js"),s=o("./node_modules/react/jsx-runtime.js");function r(e,t){return(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor",viewBox:"0 0 24 24",ref:t,...e,children:[(0,s.jsx)("path",{d:"M8 6a4 4 0 1 1 8 0v6a4 4 0 0 1-8 0z"}),(0,s.jsx)("path",{d:"M5 11a1 1 0 0 1 1 1 6 6 0 0 0 12 0 1 1 0 1 1 2 0 8 8 0 0 1-7 7.938V21a1 1 0 1 1-2 0v-1.062A8 8 0 0 1 4 12a1 1 0 0 1 1-1"})]})}r.displayName="MicOnSolidIcon";const l=(0,n.forwardRef)(r)},"./src/components/views/rooms/CollapsibleButton.tsx":(e,t,o)=>{o.d(t,{J:()=>m});var n=o("./node_modules/@babel/runtime/helpers/esm/extends.js"),s=o("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),r=o("./node_modules/react/index.js"),l=o("./src/components/views/elements/AccessibleButton.tsx"),i=o("./src/components/views/rooms/MessageComposerButtons.tsx"),c=o("./src/components/views/context_menus/IconizedContextMenu.tsx");const a=["title","children","className","inputRef"],m=e=>{let{title:t,children:o,className:m,inputRef:u}=e,d=(0,s.A)(e,a);return!!(0,r.useContext)(i.ZF)?r.createElement(c.R$,(0,n.A)({},d,{icon:o,label:t,inputRef:u})):r.createElement(l.A,(0,n.A)({},d,{title:t,className:m,ref:u}),o)}},"./src/components/views/rooms/EmojiButton.tsx":(e,t,o)=>{o.d(t,{h:()=>_});var n=o("./node_modules/@babel/runtime/helpers/esm/extends.js"),s=o("./node_modules/classnames/index.js"),r=o.n(s),l=o("./node_modules/react/index.js"),i=o("./node_modules/react/jsx-runtime.js");function c(e,t){return(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor",viewBox:"0 0 24 24",ref:t,...e,children:[(0,i.jsx)("path",{d:"M15.536 15.536a1 1 0 0 0-1.415-1.415 3 3 0 0 1-2.12.879 3 3 0 0 1-2.122-.879 1 1 0 1 0-1.414 1.415A5 5 0 0 0 12 17c1.38 0 2.632-.56 3.536-1.464M10 10.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m5.5 1.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3"}),(0,i.jsx)("path",{d:"M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10m-2 0a8 8 0 1 0-16 0 8 8 0 0 0 16 0"})]})}c.displayName="ReactionIcon";const a=(0,l.forwardRef)(c);var m=o("./src/languageHandler.tsx"),u=o("./src/components/structures/ContextMenu.tsx"),d=o("./src/components/views/emojipicker/EmojiPicker.tsx"),p=o("./src/components/views/rooms/CollapsibleButton.tsx"),x=o("./src/components/views/rooms/MessageComposerButtons.tsx");function _({addEmoji:e,menuPosition:t,className:o}){const s=(0,l.useContext)(x.ZF),[i,c,_,h]=(0,u.EF)();let g=null;if(i&&c.current){const o=null!=t?t:(0,u.qv)(c.current.getBoundingClientRect()),r=()=>{h(),null==s||s()};g=l.createElement(u.Ay,(0,n.A)({},o,{onFinished:r,managed:!1,focusLock:!0}),l.createElement(d.Ay,{onChoose:e,onFinished:r}))}const v=r()("mx_EmojiButton",o,{mx_EmojiButton_highlight:i});return l.createElement(l.Fragment,null,l.createElement(p.J,{className:v,onClick:_,title:(0,m._t)("common|emoji"),inputRef:c},l.createElement(a,null)),g)}},"./src/components/views/rooms/MessageComposerButtons.tsx":(e,t,o)=>{o.d(t,{ZF:()=>J,Ay:()=>X});var n=o("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=o("./node_modules/@babel/runtime/helpers/esm/extends.js"),r=o("./node_modules/classnames/index.js"),l=o.n(r),i=o("./node_modules/matrix-js-sdk/src/matrix.ts"),c=o("./node_modules/react/index.js"),a=o("./node_modules/@vector-im/compound-design-tokens/assets/web/icons/overflow-horizontal.js"),m=o("./node_modules/react/jsx-runtime.js");function u(e,t){return(0,m.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor",viewBox:"0 0 24 24",ref:t,...e,children:(0,m.jsx)("path",{d:"M11.5 22q-2.3 0-3.9-1.6T6 16.5V6q0-1.65 1.175-2.825T10 2t2.825 1.175T14 6v9.5q0 1.05-.725 1.775T11.5 18t-1.775-.725T9 15.5V6.75A.73.73 0 0 1 9.75 6a.73.73 0 0 1 .75.75v8.75q0 .424.287.712.288.288.713.288.424 0 .713-.288a.97.97 0 0 0 .287-.712V6q0-1.05-.725-1.775T10 3.5t-1.775.725T7.5 6v10.5q0 1.65 1.175 2.825T11.5 20.5t2.825-1.175T15.5 16.5V6.75a.73.73 0 0 1 .75-.75.73.73 0 0 1 .75.75v9.75q0 2.3-1.6 3.9T11.5 22"})})}u.displayName="AttachmentIcon";const d=(0,c.forwardRef)(u);var p=o("./node_modules/@vector-im/compound-design-tokens/assets/web/icons/mic-on-solid.js"),x=o("./node_modules/@vector-im/compound-design-tokens/assets/web/icons/polls.js");function _(e,t){return(0,m.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor",viewBox:"0 0 24 24",ref:t,...e,children:(0,m.jsx)("path",{d:"M6 19a.97.97 0 0 1-.713-.288A.97.97 0 0 1 5 18q0-.424.287-.712A.97.97 0 0 1 6 17h12q.424 0 .712.288.288.287.288.712 0 .424-.288.712A.97.97 0 0 1 18 19zm1.35-5.2 3.425-9.2a.9.9 0 0 1 .338-.437A.93.93 0 0 1 11.65 4h.7q.3 0 .537.162.238.163.338.438l3.425 9.225q.15.425-.1.8a.8.8 0 0 1-.7.375.9.9 0 0 1-.512-.162A.9.9 0 0 1 15 14.4l-.75-2.2H9.8L9 14.425a.84.84 0 0 1-.325.425q-.225.15-.5.15a.84.84 0 0 1-.738-.387.82.82 0 0 1-.087-.813m3-3.2h3.3l-1.6-4.55h-.1z"})})}_.displayName="TextFormattingIcon";const h=(0,c.forwardRef)(_);var g,v,C,w=o("./src/languageHandler.tsx"),f=o("./src/components/views/rooms/CollapsibleButton.tsx"),E=o("./src/dispatcher/dispatcher.ts"),k=o("./src/components/views/dialogs/ErrorDialog.tsx"),M=o("./src/components/views/location/index.tsx"),b=o("./src/Modal.tsx"),j=o("./src/components/views/elements/PollCreateDialog.tsx"),A=o("./src/MatrixClientPeg.ts"),y=o("./src/ContentMessages.ts"),R=o("./src/contexts/MatrixClientContext.tsx"),B=o("./src/hooks/useDispatcher.ts"),T=o("./src/utils/BrowserWorkarounds.ts"),P=o("./src/components/views/context_menus/IconizedContextMenu.tsx"),z=o("./src/components/views/rooms/EmojiButton.tsx"),N=o("./src/utils/arrays.ts"),I=o("./src/hooks/useSettings.ts"),q=o("./src/components/views/elements/AccessibleButton.tsx"),S=o("./src/contexts/ScopedRoomContext.tsx");function O(){return O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)({}).hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},O.apply(null,arguments)}var F=function(e,t){return c.createElement("svg",O({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20",role:"presentation","aria-hidden":!0,ref:t},e),g||(g=c.createElement("mask",{id:"sticker_svg__a",fill:"#fff"},c.createElement("path",{fillRule:"evenodd",d:"M8.833 19.933C3.86 19.354 0 15.128 0 10 0 4.477 4.477 0 10 0c5.153 0 9.395 3.897 9.94 8.904a1 1 0 0 0-.107-.042c-3.113-1.012-6.594-.385-8.984 2.027-2.385 2.407-3.009 5.908-2.016 9.044m1.89-.655 8.497-8.497c-2.487-.808-5.16-.282-6.96 1.534-1.784 1.8-2.312 4.47-1.538 6.963",clipRule:"evenodd"}))),v||(v=c.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M8.833 19.933C3.86 19.354 0 15.128 0 10 0 4.477 4.477 0 10 0c5.153 0 9.395 3.897 9.94 8.904a1 1 0 0 0-.107-.042c-3.113-1.012-6.594-.385-8.984 2.027-2.385 2.407-3.009 5.908-2.016 9.044m1.89-.655 8.497-8.497c-2.487-.808-5.16-.282-6.96 1.534-1.784 1.8-2.312 4.47-1.538 6.963",clipRule:"evenodd"})),C||(C=c.createElement("path",{fill:"#000",d:"m8.833 19.933-.116.99a.997.997 0 0 0 1.067-1.291zM19.94 8.904l-.416.907a.997.997 0 0 0 1.407-1.015zm-.108-.042.308-.948zm-8.984 2.027.708.702zm-.127 8.389-.952.296a.997.997 0 0 0 1.658.409zm8.498-8.497.705.705a.997.997 0 0 0-.397-1.654zm-6.96 1.534.71.702zM-.996 10c0 5.64 4.245 10.287 9.715 10.923l.23-1.981A9.004 9.004 0 0 1 .998 10zM10-.997C3.926-.997-.997 3.926-.997 10H.997A9.003 9.003 0 0 1 10 .997zm10.932 9.793C20.332 3.288 15.667-.997 10-.997V.997a9.004 9.004 0 0 1 8.95 8.015zm-1.407 1.015.831-1.813a2 2 0 0 0-.215-.084zm-7.968 1.78c2.095-2.114 5.17-2.69 7.968-1.78l.616-1.897c-3.429-1.115-7.315-.437-10 2.273zm-1.773 8.04c-.895-2.827-.319-5.929 1.773-8.04l-1.417-1.404C7.463 12.89 6.792 16.79 7.882 20.234zm1.643.352 8.498-8.497-1.41-1.41-8.498 8.497zm8.1-10.151c-2.803-.911-5.882-.332-7.975 1.78l1.417 1.405c1.505-1.519 3.773-1.993 5.942-1.288zm-7.975 1.78c-2.074 2.094-2.652 5.16-1.782 7.961l1.905-.59c-.678-2.185-.2-4.458 1.294-5.966z",mask:"url(#sticker_svg__a)"})))},D=(0,c.forwardRef)(F);const J=(0,c.createContext)(null);function L(e){return c.createElement(z.h,{key:"emoji_button",addEmoji:e.addEmoji,menuPosition:e.menuPosition,className:"mx_MessageComposer_button"})}function H(){return c.createElement(Z,{key:"controls_upload"})}const V=(0,c.createContext)(null),U=({roomId:e,relation:t,children:o})=>{const n=(0,c.useContext)(R.Ay),s=(0,S.ME)("timelineRenderingType","replyToEvent"),r=(0,c.useRef)(null),l=()=>{var e;null!=n&&n.isGuest()?E.A.dispatch({action:"require_registration"}):null===(e=r.current)||void 0===e||e.click()};(0,B.F)(E.A,e=>{s.timelineRenderingType===e.context&&"upload_file"===e.action&&l()});return c.createElement(V.Provider,{value:l},o,c.createElement("input",{ref:r,type:"file",style:{display:"none"},multiple:!0,onClick:T.e,onChange:o=>{var r;0!==(null===(r=o.target.files)||void 0===r?void 0:r.length)&&(y.Ay.sharedInstance().sendContentListToRoom(Array.from(o.target.files),e,t,s.replyToEvent,n,s.timelineRenderingType),o.target.value="")}}))},Z=()=>{const e=(0,c.useContext)(J),t=(0,c.useContext)(V);return c.createElement(f.J,{className:"mx_MessageComposer_button",onClick:()=>{null==t||t(),null==e||e()},title:(0,w._t)("common|attachment")},c.createElement(d,null))};function G(e){return e.showStickersButton?c.createElement(f.J,{id:"stickersButton",key:"controls_stickers",className:"mx_MessageComposer_button",onClick:()=>e.setStickerPickerOpen(!e.isStickerPickerOpen),title:e.isStickerPickerOpen?(0,w._t)("composer|close_sticker_picker"):(0,w._t)("common|sticker")},c.createElement(D,null)):null}function W(e,t){return t?null:c.createElement(f.J,{key:"voice_message_send",className:"mx_MessageComposer_button",onClick:e.onRecordStartEndClick,title:(0,w._t)("composer|voice_message_button")},c.createElement(p.A,null))}function Y(e,t){return c.createElement($,{key:"polls",room:e,relation:t})}class $ extends c.PureComponent{constructor(...e){super(...e),(0,n.A)(this,"onCreateClick",()=>{var e;null===(e=this.context)||void 0===e||e.call(this);if(this.props.room.currentState.maySendEvent(i.M_POLL_START.name,A.J.safeGet().getSafeUserId())){var t;const e=(null===(t=this.props.relation)||void 0===t?void 0:t.rel_type)===i.THREAD_RELATION_TYPE.name?this.props.relation.event_id:void 0;b.Ay.createDialog(j.A,{room:this.props.room,threadId:e},"mx_CompoundDialog",!1,!0)}else b.Ay.createDialog(k.A,{title:(0,w._t)("composer|poll_button_no_perms_title"),description:(0,w._t)("composer|poll_button_no_perms_description")})})}render(){var e;return(null===(e=this.props.relation)||void 0===e?void 0:e.rel_type)===i.THREAD_RELATION_TYPE.name?null:c.createElement(f.J,{className:"mx_MessageComposer_button",onClick:this.onCreateClick,title:(0,w._t)("composer|poll_button")},c.createElement(x.A,null))}}function K(e,t,o){const n=t.getMember(o.getSafeUserId());return e.showLocationButton&&n?c.createElement(M.Uo,{key:"location",roomId:t.roomId,relation:e.relation,sender:n,menuPosition:e.menuPosition}):null}function Q({isRichTextEnabled:e,onClick:t}){const o=e?(0,w._t)("composer|mode_plain"):(0,w._t)("composer|mode_rich_text");return c.createElement(f.J,{className:"mx_MessageComposer_button",onClick:t,title:o},c.createElement(h,null))}(0,n.A)($,"contextType",J);const X=e=>{const t=(0,c.useContext)(R.Ay),{room:o,narrow:n}=(0,S.ME)("room","narrow"),r=(0,I.ti)("feature_wysiwyg_composer");if(!t||!o||e.haveRecording)return null;let i,m;n?(i=[r?c.createElement(Q,{key:"composerModeButton",isRichTextEnabled:e.isRichTextEnabled,onClick:e.onComposerModeClick}):L(e)],m=[H(),G(e),W(e,n),e.showPollsButton?Y(o,e.relation):null,K(e,o,t)]):(i=[r?c.createElement(Q,{key:"composerModeButton",isRichTextEnabled:e.isRichTextEnabled,onClick:e.onComposerModeClick}):L(e),H()],m=[G(e),W(e,n),e.showPollsButton?Y(o,e.relation):null,K(e,o,t)]),i=(0,N.Bo)(i),m=(0,N.Bo)(m);const u=l()({mx_MessageComposer_button:!0,mx_MessageComposer_buttonMenu:!0,mx_MessageComposer_closeButtonMenu:e.isMenuOpen});return c.createElement(U,{roomId:o.roomId,relation:e.relation},i,m.length>0&&c.createElement(q.A,{className:u,onClick:e.toggleButtonMenu,title:(0,w._t)("quick_settings|sidebar_settings")},c.createElement(a.A,null)),e.isMenuOpen&&c.createElement(P.Ay,(0,s.A)({onFinished:e.toggleButtonMenu},e.menuPosition,{wrapperClassName:"mx_MessageComposer_Menu",compact:!0}),c.createElement(J.Provider,{value:e.toggleButtonMenu},c.createElement(P.tx,null,m))))}}}]);
//# sourceMappingURL=5215.js.map